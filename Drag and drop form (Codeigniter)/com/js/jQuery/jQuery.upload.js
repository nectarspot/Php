(function(e){e.fn.pekeUpload=function(t){function o(){var n=true;if(t.theme=="bootstrap"){var s='<br /><div class="file">                              <div class="filename"></div>                               <div class="progress">                                 <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" style="width: 60%;">                                  <span class="sr-only">60% Complete</span>                               </div>                            </div>                           </div>'}if(t.theme=="custom"){var s='<div class="file"><div class="filename"></div><div class="progress-pekeupload"><div class="bar-pekeupload pekeup-progress-bar" style="width: 0%;"><span></span></div></div></div>'}r.next("a").next("div").prepend(s);var o=new FormData;o.append(t.field,r[0].files[0]);o.append("data",t.data);e.ajax({url:t.url,type:"POST",data:o,success:function(e){var s=100;r.next("a").next("div").find(".progress-bar:first").width(s+"%");r.next("a").next("div").find(".progress-bar:first").text(s+"%");if(e==1){if(t.multi==false){r.attr("disabled","disabled")}t.onFileSuccess(i,e)}else{t.onFileError(i,e);r.next("a").next("div").find(".file:first").remove();if(t.theme=="bootstrap"&&t.showErrorAlerts==true){r.next("a").next("div").prepend('<div class="alert alert-error"><button type="button" class="close" data-dismiss="alert">&times;</button> '+e+"</div>");c()}if(t.theme=="custom"&&t.showErrorAlerts==true){r.next("a").next("div").prepend('<div class="alert-pekeupload"><button type="button" class="close" data-dismiss="alert">&times;</button> '+e+"</div>");h()}n=false}},xhr:function(){myXhr=e.ajaxSettings.xhr();if(myXhr.upload){myXhr.upload.addEventListener("progress",u,false)}return myXhr},cache:false,contentType:false,processData:false});return n}function u(e){if(e.lengthComputable){var n=e.total;var s=e.loaded;if(t.showFilename==true){r.next("a").next("div").find(".file").first().find(".filename:first").text(i.name)}if(t.showPercent==true){var o=Number((e.loaded*100/e.total).toFixed(2));r.next("a").next("div").find(".file").first().find(".pekeup-progress-bar:first").width(o+"%")}r.next("a").next("div").find(".file").first().find(".pekeup-progress-bar:first").html("<center>"+o+"%</center>")}}function a(){var e=true;if(t.allowedExtensions!=""){var n=f();if(n==false){e=false;if(t.theme=="bootstrap"&&t.showErrorAlerts==true){r.next("a").next("div").prepend('<div class="alert alert-error"><button type="button" class="close" data-dismiss="alert">&times;</button> '+t.invalidExtError+"</div>");c()}if(t.theme=="custom"&&t.showErrorAlerts==true){r.next("a").next("div").prepend('<div class="alert-pekeupload"><button type="button" class="close">&times;</button> '+t.invalidExtError+"</div>");h()}}else{e=true}}if(t.maxSize>0){var n=l();if(n==false){e=false;if(t.theme=="bootstrap"&&t.showErrorAlerts==true){r.next("a").next("div").prepend('<div class="alert alert-error"><button type="button" class="close" data-dismiss="alert">&times;</button> '+t.sizeError+"</div>");c()}if(t.theme=="custom"&&t.showErrorAlerts==true){r.next("a").next("div").prepend('<div class="alert-pekeupload"><button type="button" class="close" data-dismiss="alert">&times;</button> '+t.sizeError+"</div>");h()}t.onFileError(i,t.sizeError)}else{e=true}}return e}function f(){var n=r.val().split(".").pop().toLowerCase();var i=t.allowedExtensions.split("|");if(e.inArray(n,i)==-1){return false}else{return true}}function l(){if(i.size>t.maxSize){return false}else{return true}}function c(){r.next("a").next("div").find(".alert-error").click(function(){e(this).remove()})}function h(){r.next("a").next("div").find(".alert-pekeupload").click(function(){e(this).remove()})}var n={onSubmit:false,btnText:"Browse files...",url:"com/php/core-uploader.php",theme:"custom",field:"file",data:null,multi:true,showFilename:false,showPercent:true,showErrorAlerts:false,allowedExtensions:"",invalidExtError:"Invalid File Type2",maxSize:0,sizeError:"Size of the file you`ve tried to upload is too big. Please try again.",onFileError:function(e,t){},onFileSuccess:function(e,t){}};var t=e.extend(n,t);var r;var i=new Object;var s=this;this.each(function(){r=e(this);if(t.theme=="bootstrap"){var n='<a href="javascript:void(0)" class="btn btn-primary btn-upload"> <span class="icon-upload icon-white"></span> '+t.btnText+'</a><div class="pekecontainer"></div>'}if(t.theme=="custom"){var n='<a href="javascript:void(0)" class="btn-pekeupload">'+t.btnText+'</a><div class="pekecontainer"></div>'}r.after(n);r.hide();r.next("a").click(function(){r.click()});r.change(function(){i.name=r.val().split("\\").pop();i.size=r[0].files[0].size/1024/1024;if(a()==true){if(t.onSubmit==false){o()}else{r.next("a").next("div").prepend('<br /><span class="filename">'+i.name+"</span>");r.parent("form").bind("submit",function(){r.next("a").next("div").html("");o()})}}})})}})(jQuery)